<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2018-03-12
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20180312" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Falcon - Configuring Falcon</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

                          
        
<script type="text/javascript">$( document ).ready( function() { $( '.carousel' ).carousel( { interval: 3500 } ) } );</script>
          
            </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href="../index.html" id="bannerLeft">
                                                                                                <img src="images/falcon-logo.png"  alt="Apache Falcon" width="200px" height="45px"/>
                </a>
                      </div>
        <div class="pull-right">                  <a href="http://www.apache.org" id="bannerRight">
                                                                                                <img src="images/apache-feather-tm.gif"  alt="Falcon" height="45px"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="http://www.apache.org" class="externalLink" title="Apache">
        Apache</a>
        </li>
      <li class="divider ">/</li>
            <li class="">
                    <a href="index.html" title="Falcon">
        Falcon</a>
        </li>
      <li class="divider ">/</li>
        <li class="">Configuring Falcon</li>
        
                
                    
                  <li id="publishDate" class="pull-right">Last Published: 2018-03-12</li> 
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Falcon</li>
                                
      <li>
    
                          <a href="index.html" title="About">
          <i class="none"></i>
        About</a>
            </li>
                  
      <li>
    
                          <a href="slides/falcon-overview.html" title="Overview">
          <i class="none"></i>
        Overview</a>
            </li>
                  
      <li>
    
                          <a href="slides/falcon-user-guide.html" title="User Guide">
          <i class="none"></i>
        User Guide</a>
            </li>
                  
      <li>
    
                          <a href="GettingStarted.html" title="Getting Started">
          <i class="none"></i>
        Getting Started</a>
            </li>
                  
      <li>
    
                          <a href="FalconDocumentation.html" title="Architecture">
          <i class="none"></i>
        Architecture</a>
            </li>
                  
      <li>
    
                          <a href="InstallationSteps.html" title="Installation">
          <i class="none"></i>
        Installation</a>
            </li>
                  
      <li>
    
                          <a href="OnBoarding.html" title="On Boarding">
          <i class="none"></i>
        On Boarding</a>
            </li>
                  
      <li>
    
                          <a href="MigrationInstructions.html" title="Migrate to 0.10">
          <i class="none"></i>
        Migrate to 0.10</a>
            </li>
                  
      <li>
    
                          <a href="Operability.html" title="Operability">
          <i class="none"></i>
        Operability</a>
            </li>
                  
      <li>
    
                          <a href="EntitySpecification.html" title="Entity Specification">
          <i class="none"></i>
        Entity Specification</a>
            </li>
                  
      <li>
    
                          <a href="falconcli/FalconCLI.html" title="Client (Falcon CLI)">
          <i class="none"></i>
        Client (Falcon CLI)</a>
            </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
      <li>
    
                          <a href="restapi/ResourceList.html" title="Rest API">
          <i class="icon-chevron-right"></i>
        Rest API</a>
                  </li>
                  
      <li>
    
                          <a href="HiveIntegration.html" title="Hive Integration">
          <i class="none"></i>
        Hive Integration</a>
            </li>
                  
      <li>
    
                          <a href="Extensions.html" title="Server side Extensions">
          <i class="none"></i>
        Server side Extensions</a>
            </li>
                  
      <li>
    
                          <a href="Security.html" title="Security">
          <i class="none"></i>
        Security</a>
            </li>
                              <li class="nav-header">Project Information</li>
                                
      <li>
    
                          <a href="project-info.html" title="Summary">
          <i class="none"></i>
        Summary</a>
            </li>
                  
      <li>
    
                          <a href="mail-lists.html" title="Mailing Lists">
          <i class="none"></i>
        Mailing Lists</a>
            </li>
                  
      <li>
    
                          <a href="http://webchat.freenode.net?channels=apachefalcon&uio=d4" class="externalLink" title="IRC">
          <i class="none"></i>
        IRC</a>
            </li>
                  
      <li>
    
                          <a href="team-list.html" title="Team">
          <i class="none"></i>
        Team</a>
            </li>
                  
      <li>
    
                          <a href="issue-tracking.html" title="Issue Tracking">
          <i class="none"></i>
        Issue Tracking</a>
            </li>
                  
      <li>
    
                          <a href="source-repository.html" title="Source Repository">
          <i class="none"></i>
        Source Repository</a>
            </li>
                  
      <li>
    
                          <a href="https://cwiki.apache.org/confluence/display/FALCON/Index" class="externalLink" title="Wiki">
          <i class="none"></i>
        Wiki</a>
            </li>
                  
      <li>
    
                          <a href="license.html" title="License">
          <i class="none"></i>
        License</a>
            </li>
                  
      <li>
    
                          <a href="https://cwiki.apache.org/confluence/display/FALCON/News" class="externalLink" title="News">
          <i class="none"></i>
        News</a>
            </li>
                  
      <li>
    
                          <a href="https://cwiki.apache.org/confluence/display/FALCON/PoweredBy" class="externalLink" title="Powered by">
          <i class="none"></i>
        Powered by</a>
            </li>
                  
      <li>
    
                          <a href="https://cwiki.apache.org/confluence/display/FALCON/Acknowledgements" class="externalLink" title="Acknowledgements">
          <i class="none"></i>
        Acknowledgements</a>
            </li>
                  
      <li>
    
                          <a href="http://blogs.apache.org/falcon/" class="externalLink" title="Blog">
          <i class="none"></i>
        Blog</a>
            </li>
                              <li class="nav-header">Releases</li>
                                
      <li>
    
                          <a href="http://www.apache.org/dyn/closer.lua/falcon/0.11" class="externalLink" title="0.11">
          <i class="none"></i>
        0.11</a>
            </li>
                  
      <li>
    
                          <a href="http://www.apache.org/dyn/closer.lua/falcon/0.10" class="externalLink" title="0.10">
          <i class="none"></i>
        0.10</a>
            </li>
                  
      <li>
    
                          <a href="http://www.apache.org/dyn/closer.lua/falcon/0.9" class="externalLink" title="0.9">
          <i class="none"></i>
        0.9</a>
            </li>
                  
      <li>
    
                          <a href="http://www.apache.org/dyn/closer.lua/falcon/0.8" class="externalLink" title="0.8">
          <i class="none"></i>
        0.8</a>
            </li>
                  
      <li>
    
                          <a href="http://www.apache.org/dyn/closer.lua/falcon/0.7" class="externalLink" title="0.7">
          <i class="none"></i>
        0.7</a>
            </li>
                  
      <li>
    
                          <a href="http://archive.apache.org/dist/falcon/0.6.1" class="externalLink" title="0.6.1">
          <i class="none"></i>
        0.6.1</a>
            </li>
                  
      <li>
    
                          <a href="http://archive.apache.org/dist/incubator/falcon/0.6-incubating" class="externalLink" title="0.6-incubating">
          <i class="none"></i>
        0.6-incubating</a>
            </li>
                  
      <li>
    
                          <a href="http://archive.apache.org/dist/incubator/falcon/0.5-incubating" class="externalLink" title="0.5-incubating">
          <i class="none"></i>
        0.5-incubating</a>
            </li>
                  
      <li>
    
                          <a href="http://archive.apache.org/dist/incubator/falcon/0.4-incubating" class="externalLink" title="0.4-incubating">
          <i class="none"></i>
        0.4-incubating</a>
            </li>
                  
      <li>
    
                          <a href="http://archive.apache.org/dist/incubator/falcon/0.3-incubating" class="externalLink" title="0.3-incubating">
          <i class="none"></i>
        0.3-incubating</a>
            </li>
                  
      <li>
    
                          <a href="https://cwiki.apache.org/confluence/display/FALCON/Roadmap" class="externalLink" title="Coming soon">
          <i class="none"></i>
        Coming soon</a>
            </li>
                              <li class="nav-header">Documentation</li>
                                
      <li>
    
                          <a href="0.11/index.html" title="0.11 (Current)">
          <i class="none"></i>
        0.11 (Current)</a>
            </li>
                  
      <li>
    
                          <a href="0.10/index.html" title="0.10">
          <i class="none"></i>
        0.10</a>
            </li>
                  
      <li>
    
                          <a href="0.9/index.html" title="0.9">
          <i class="none"></i>
        0.9</a>
            </li>
                  
      <li>
    
                          <a href="0.8/index.html" title="0.8">
          <i class="none"></i>
        0.8</a>
            </li>
                  
      <li>
    
                          <a href="0.7/index.html" title="0.7">
          <i class="none"></i>
        0.7</a>
            </li>
                  
      <li>
    
                          <a href="0.6.1/index.html" title="0.6.1">
          <i class="none"></i>
        0.6.1</a>
            </li>
                  
      <li>
    
                          <a href="0.6-incubating/index.html" title="0.6-incubating">
          <i class="none"></i>
        0.6-incubating</a>
            </li>
                  
      <li>
    
                          <a href="0.5-incubating/index.html" title="0.5-incubating">
          <i class="none"></i>
        0.5-incubating</a>
            </li>
                  
      <li>
    
                          <a href="0.4-incubating/index.html" title="0.4-incubating">
          <i class="none"></i>
        0.4-incubating</a>
            </li>
                  
      <li>
    
                          <a href="0.3-incubating/index.html" title="0.3-incubating">
          <i class="none"></i>
        0.3-incubating</a>
            </li>
                              <li class="nav-header">ASF</li>
                                
      <li>
    
                          <a href="http://www.apache.org/foundation/how-it-works.html" class="externalLink" title="How Apache Works">
          <i class="none"></i>
        How Apache Works</a>
            </li>
                  
      <li>
    
                          <a href="http://www.apache.org/foundation/" class="externalLink" title="Foundation">
          <i class="none"></i>
        Foundation</a>
            </li>
                  
      <li>
    
                          <a href="http://www.apache.org/foundation/sponsorship.html" class="externalLink" title="Sponsoring Apache">
          <i class="none"></i>
        Sponsoring Apache</a>
            </li>
                  
      <li>
    
                          <a href="http://www.apache.org/foundation/thanks.html" class="externalLink" title="Thanks">
          <i class="none"></i>
        Thanks</a>
            </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section">
<h2>Configuring Falcon<a name="Configuring_Falcon"></a></h2>
<p>By default config directory used by falcon is {package dir}/conf. To override this (to use the same conf with multiple falcon upgrades), set environment variable FALCON_CONF to the path of the conf dir.</p>
<p>falcon-env.sh has been added to the falcon conf. This file can be used to set various environment variables that you need for you services. In addition you can set any other environment variables you might need. This file will be sourced by falcon scripts before any commands are executed. The following environment variables are available to set.</p>
<div class="source">
<pre>
# The java implementation to use. If JAVA_HOME is not found we expect java and jar to be in path
#export JAVA_HOME=

# any additional java opts you want to set. This will apply to both client and server operations
#export FALCON_OPTS=

# any additional java opts that you want to set for client only
#export FALCON_CLIENT_OPTS=

# java heap size we want to set for the client. Default is 1024MB
#export FALCON_CLIENT_HEAP=

# any additional opts you want to set for prism service.
#export FALCON_PRISM_OPTS=

# java heap size we want to set for the prism service. Default is 1024MB
#export FALCON_PRISM_HEAP=

# any additional opts you want to set for falcon service.
#export FALCON_SERVER_OPTS=

# java heap size we want to set for the falcon server. Default is 1024MB
#export FALCON_SERVER_HEAP=

# What is is considered as falcon home dir. Default is the base location of the installed software
#export FALCON_HOME_DIR=

# Where log files are stored. Default is logs directory under the base install location
#export FALCON_LOG_DIR=

# Where pid files are stored. Default is logs directory under the base install location
#export FALCON_PID_DIR=

# where the falcon active mq data is stored. Default is logs/data directory under the base install location
#export FALCON_DATA_DIR=

# Where do you want to expand the war file. By Default it is in /server/webapp dir under the base install dir.
#export FALCON_EXPANDED_WEBAPP_DIR=

# Any additional classpath elements to be added to the Falcon server/client classpath
#export FALCON_EXTRA_CLASS_PATH=

</pre></div></div>
<div class="section">
<h3>Advanced Configurations<a name="Advanced_Configurations"></a></h3></div>
<div class="section">
<h4>Configuring Monitoring plugin to register catalog partitions<a name="Configuring_Monitoring_plugin_to_register_catalog_partitions"></a></h4>
<p>Falcon comes with a monitoring plugin that registers catalog partition. This comes in really handy during migration from  filesystem based feeds to hcatalog based feeds. This plugin enables the user to de-couple the partition registration and assume that all partitions are already on hcatalog even before the migration, simplifying the hcatalog migration.</p>
<p>By default this plugin is disabled. To enable this plugin and leverage the feature, there are 3 pre-requisites:</p>
<div class="source">
<pre>
In {package dir}/conf/startup.properties, add
*.workflow.execution.listeners=org.apache.falcon.catalog.CatalogPartitionHandler

In the cluster definition, ensure registry endpoint is defined.
Ex:
&lt;interface type=&quot;registry&quot; endpoint=&quot;thrift://localhost:1109&quot; version=&quot;0.13.3&quot;/&gt;

In the feed definition, ensure the corresponding catalog table is mentioned in feed-properties
Ex:
&lt;properties&gt;
    &lt;property name=&quot;catalog.table&quot; value=&quot;catalog:default:in_table#year={YEAR};month={MONTH};day={DAY};hour={HOUR};
    minute={MINUTE}&quot;/&gt;
&lt;/properties&gt;

</pre></div>
<p><b>NOTE : for Mac OS users</b></p>
<div class="source">
<pre>
If you are using a Mac OS, you will need to configure the FALCON_SERVER_OPTS (explained above).

In  {package dir}/conf/falcon-env.sh uncomment the following line
#export FALCON_SERVER_OPTS=

and change it to look as below
export FALCON_SERVER_OPTS=&quot;-Djava.awt.headless=true -Djava.security.krb5.realm= -Djava.security.krb5.kdc=&quot;

</pre></div></div>
<div class="section">
<h4>Activemq<a name="Activemq"></a></h4>
<p>* falcon server starts embedded active mq. To control this behaviour, set the following system properties using -D option in environment variable FALCON_OPTS:</p>
<ul>
<li>falcon.embeddedmq=&lt;true/false&gt; - Should server start embedded active mq, default true</li>
<li>falcon.embeddedmq.port=&lt;port&gt; - Port for embedded active mq, default 61616</li>
<li>falcon.embeddedmq.data=&lt;path&gt; - Data path for embedded active mq, default {package dir}/logs/data</li></ul></div>
<div class="section">
<h4>Falcon System Notifications<a name="Falcon_System_Notifications"></a></h4>
<p>Some Falcon features such as late data handling, retries, metadata service, depend on JMS notifications sent when the Oozie workflow completes. Falcon listens to Oozie notification via JMS. You need to enable Oozie JMS notification as explained below. Falcon post processing feature continues to only send user notifications so enabling Oozie JMS notification is important.</p></div>
<div class="section">
<h4>Enable Oozie JMS notification<a name="Enable_Oozie_JMS_notification"></a></h4>
<p></p>
<ul>
<li>Please add/change the following properties in oozie-site.xml in the oozie installation dir.</li></ul>
<div class="source">
<pre>
   &lt;property&gt;
      &lt;name&gt;oozie.jms.producer.connection.properties&lt;/name&gt;
      &lt;value&gt;java.naming.factory.initial#org.apache.activemq.jndi.ActiveMQInitialContextFactory;java.naming.provider.url#tcp://&lt;activemq-host&gt;:&lt;port&gt;&lt;/value&gt;
    &lt;/property&gt;

   &lt;property&gt;
      &lt;name&gt;oozie.service.EventHandlerService.event.listeners&lt;/name&gt;
      &lt;value&gt;org.apache.oozie.jms.JMSJobEventListener&lt;/value&gt;
   &lt;/property&gt;

   &lt;property&gt;
      &lt;name&gt;oozie.service.JMSTopicService.topic.name&lt;/name&gt;
      &lt;value&gt;WORKFLOW=ENTITY.TOPIC,COORDINATOR=ENTITY.TOPIC&lt;/value&gt;
    &lt;/property&gt;

   &lt;property&gt;
      &lt;name&gt;oozie.service.JMSTopicService.topic.prefix&lt;/name&gt;
      &lt;value&gt;FALCON.&lt;/value&gt;
    &lt;/property&gt;

    &lt;!-- add org.apache.oozie.service.JMSAccessorService to the other existing services if any --&gt;
    &lt;property&gt;
       &lt;name&gt;oozie.services.ext&lt;/name&gt;
       &lt;value&gt;org.apache.oozie.service.JMSAccessorService,org.apache.oozie.service.PartitionDependencyManagerService,org.apache.oozie.service.HCatAccessorService&lt;/value&gt;
    &lt;/property&gt;

</pre></div>
<p></p>
<ul>
<li>In falcon startup.properties, set JMS broker url to be the same as the one set in oozie-site.xml property</li></ul>oozie.jms.producer.connection.properties (see above)
<div class="source">
<pre>
   *.broker.url=tcp://&lt;activemq-host&gt;:&lt;port&gt;

</pre></div></div>
<div class="section">
<h4>Configuring Oozie for Falcon<a name="Configuring_Oozie_for_Falcon"></a></h4>
<p>Falcon uses HCatalog for data availability notification when Hive tables are replicated. Make the following configuration changes to Oozie to ensure Hive table replication in Falcon:</p>
<p></p>
<ul>
<li>Stop the Oozie service on all Falcon clusters. Run the following commands on the Oozie host machine.</li></ul>
<div class="source">
<pre>
su - $OOZIE_USER

&lt;oozie-install-dir&gt;/bin/oozie-stop.sh

where $OOZIE_USER is the Oozie user. For example, oozie.

</pre></div>
<p></p>
<ul>
<li>Copy each cluster's hadoop conf directory to a different location. For example, if you have two clusters, copy one to /etc/hadoop/conf-1 and the other to /etc/hadoop/conf-2.</li></ul>
<p></p>
<ul>
<li>For each oozie-site.xml file, modify the oozie.service.HadoopAccessorService.hadoop.configurations property, specifying clusters, the RPC ports of the NameNodes, and HostManagers accordingly. For example, if Falcon connects to three clusters, specify:</li></ul>
<div class="source">
<pre>

&lt;property&gt;
     &lt;name&gt;oozie.service.HadoopAccessorService.hadoop.configurations&lt;/name&gt;
     &lt;value&gt;*=/etc/hadoop/conf,$NameNode:$rpcPortNN=$hadoopConfDir1,$ResourceManager1:$rpcPortRM=$hadoopConfDir1,$NameNode2=$hadoopConfDir2,$ResourceManager2:$rpcPortRM=$hadoopConfDir2,$NameNode3 :$rpcPortNN =$hadoopConfDir3,$ResourceManager3 :$rpcPortRM =$hadoopConfDir3&lt;/value&gt;
     &lt;description&gt;
          Comma separated AUTHORITY=HADOOP_CONF_DIR, where AUTHORITY is the HOST:PORT of
          the Hadoop service (JobTracker, HDFS). The wildcard '*' configuration is
          used when there is no exact match for an authority. The HADOOP_CONF_DIR contains
          the relevant Hadoop *-site.xml files. If the path is relative is looked within
          the Oozie configuration directory; though the path can be absolute (i.e. to point
          to Hadoop client conf/ directories in the local filesystem.
     &lt;/description&gt;
&lt;/property&gt;


</pre></div>
<p></p>
<ul>
<li>Add the following properties to the /etc/oozie/conf/oozie-site.xml file:</li></ul>
<div class="source">
<pre>

&lt;property&gt;
     &lt;name&gt;oozie.service.ProxyUserService.proxyuser.falcon.hosts&lt;/name&gt;
     &lt;value&gt;*&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
     &lt;name&gt;oozie.service.ProxyUserService.proxyuser.falcon.groups&lt;/name&gt;
     &lt;value&gt;*&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
     &lt;name&gt;oozie.service.URIHandlerService.uri.handlers&lt;/name&gt;
     &lt;value&gt;org.apache.oozie.dependency.FSURIHandler, org.apache.oozie.dependency.HCatURIHandler&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
     &lt;name&gt;oozie.services.ext&lt;/name&gt;
     &lt;value&gt;org.apache.oozie.service.JMSAccessorService, org.apache.oozie.service.PartitionDependencyManagerService,
     org.apache.oozie.service.HCatAccessorService&lt;/value&gt;
&lt;/property&gt;

&lt;!-- Coord EL Functions Properties --&gt;

&lt;property&gt;
     &lt;name&gt;oozie.service.ELService.ext.functions.coord-job-submit-instances&lt;/name&gt;
     &lt;value&gt;now=org.apache.oozie.extensions.OozieELExtensions#ph1_now_echo,
         today=org.apache.oozie.extensions.OozieELExtensions#ph1_today_echo,
         yesterday=org.apache.oozie.extensions.OozieELExtensions#ph1_yesterday_echo,
         currentMonth=org.apache.oozie.extensions.OozieELExtensions#ph1_currentMonth_echo,
         lastMonth=org.apache.oozie.extensions.OozieELExtensions#ph1_lastMonth_echo,
         currentYear=org.apache.oozie.extensions.OozieELExtensions#ph1_currentYear_echo,
         lastYear=org.apache.oozie.extensions.OozieELExtensions#ph1_lastYear_echo,
         formatTime=org.apache.oozie.coord.CoordELFunctions#ph1_coord_formatTime_echo,
         latest=org.apache.oozie.coord.CoordELFunctions#ph2_coord_latest_echo,
         future=org.apache.oozie.coord.CoordELFunctions#ph2_coord_future_echo
     &lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
     &lt;name&gt;oozie.service.ELService.ext.functions.coord-action-create-inst&lt;/name&gt;
     &lt;value&gt;now=org.apache.oozie.extensions.OozieELExtensions#ph2_now_inst,
         today=org.apache.oozie.extensions.OozieELExtensions#ph2_today_inst,
         yesterday=org.apache.oozie.extensions.OozieELExtensions#ph2_yesterday_inst,
         currentMonth=org.apache.oozie.extensions.OozieELExtensions#ph2_currentMonth_inst,
         lastMonth=org.apache.oozie.extensions.OozieELExtensions#ph2_lastMonth_inst,
         currentYear=org.apache.oozie.extensions.OozieELExtensions#ph2_currentYear_inst,
         lastYear=org.apache.oozie.extensions.OozieELExtensions#ph2_lastYear_inst,
         latest=org.apache.oozie.coord.CoordELFunctions#ph2_coord_latest_echo,
         future=org.apache.oozie.coord.CoordELFunctions#ph2_coord_future_echo,
         formatTime=org.apache.oozie.coord.CoordELFunctions#ph2_coord_formatTime,
         user=org.apache.oozie.coord.CoordELFunctions#coord_user
     &lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
&lt;name&gt;oozie.service.ELService.ext.functions.coord-action-start&lt;/name&gt;
&lt;value&gt;
now=org.apache.oozie.extensions.OozieELExtensions#ph2_now,
today=org.apache.oozie.extensions.OozieELExtensions#ph2_today,
yesterday=org.apache.oozie.extensions.OozieELExtensions#ph2_yesterday,
currentMonth=org.apache.oozie.extensions.OozieELExtensions#ph2_currentMonth,
lastMonth=org.apache.oozie.extensions.OozieELExtensions#ph2_lastMonth,
currentYear=org.apache.oozie.extensions.OozieELExtensions#ph2_currentYear,
lastYear=org.apache.oozie.extensions.OozieELExtensions#ph2_lastYear,
latest=org.apache.oozie.coord.CoordELFunctions#ph3_coord_latest,
future=org.apache.oozie.coord.CoordELFunctions#ph3_coord_future,
dataIn=org.apache.oozie.extensions.OozieELExtensions#ph3_dataIn,
instanceTime=org.apache.oozie.coord.CoordELFunctions#ph3_coord_nominalTime,
dateOffset=org.apache.oozie.coord.CoordELFunctions#ph3_coord_dateOffset,
formatTime=org.apache.oozie.coord.CoordELFunctions#ph3_coord_formatTime,
user=org.apache.oozie.coord.CoordELFunctions#coord_user
&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
     &lt;name&gt;oozie.service.ELService.ext.functions.coord-sla-submit&lt;/name&gt;
     &lt;value&gt;
         instanceTime=org.apache.oozie.coord.CoordELFunctions#ph1_coord_nominalTime_echo_fixed,
         user=org.apache.oozie.coord.CoordELFunctions#coord_user
     &lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
     &lt;name&gt;oozie.service.ELService.ext.functions.coord-sla-create&lt;/name&gt;
     &lt;value&gt;
         instanceTime=org.apache.oozie.coord.CoordELFunctions#ph2_coord_nominalTime,
         user=org.apache.oozie.coord.CoordELFunctions#coord_user
     &lt;/value&gt;
&lt;/property&gt;


</pre></div>
<p></p>
<ul>
<li>Copy the existing Oozie WAR file to &lt;oozie-install-dir&gt;/oozie.war. This will ensure that all existing items in the WAR file are still present after the current update.</li></ul>
<div class="source">
<pre>
su - root
cp $CATALINA_BASE/webapps/oozie.war &lt;oozie-install-dir&gt;/oozie.war

where $CATALINA_BASE is the path for the Oozie web app. By default, $CATALINA_BASE is: &lt;oozie-install-dir&gt;

</pre></div>
<p></p>
<ul>
<li>Add the Falcon EL extensions to Oozie.</li></ul>
<p>Copy the extension JAR files provided with the Falcon Server to a temporary directory on the Oozie server. For example, if your standalone Falcon Server is on the same machine as your Oozie server, you can just copy the JAR files.</p>
<div class="source">
<pre>

mkdir /tmp/falcon-oozie-jars
cp &lt;falcon-install-dir&gt;/oozie/ext/falcon-oozie-el-extension-&lt;$version&gt;.jar /tmp/falcon-oozie-jars
cp /tmp/falcon-oozie-jars/falcon-oozie-el-extension-&lt;$version&gt;.jar &lt;oozie-install-dir&gt;/libext


</pre></div>
<p></p>
<ul>
<li>Package the Oozie WAR file as the Oozie user</li></ul>
<div class="source">
<pre>
su - $OOZIE_USER
cd &lt;oozie-install-dir&gt;/bin
./oozie-setup.sh prepare-war

Where $OOZIE_USER is the Oozie user. For example, oozie.

</pre></div>
<p></p>
<ul>
<li>Start the Oozie service on all Falcon clusters. Run these commands on the Oozie host machine.</li></ul>
<div class="source">
<pre>
su - $OOZIE_USER
&lt;oozie-install-dir&gt;/bin/oozie-start.sh

Where $OOZIE_USER is the Oozie user. For example, oozie.

</pre></div></div>
<div class="section">
<h4>Enabling Falcon Native Scheudler<a name="Enabling_Falcon_Native_Scheudler"></a></h4>
<p><verbatim>$FALCON_HOME/conf/startup.properties</verbatim> before starting the Falcon Server. For details on the same, refer to <a href="./FalconNativeScheduler.html">Falcon Native Scheduler</a></p></div>
<div class="section">
<h4>Titan GraphDB backend<a name="Titan_GraphDB_backend"></a></h4>
<p>GraphDB backend needs to be configured to properly start Falcon server. You can either choose to use 5.0.73 version of berkeleydb (the default for Falcon for the last few releases) or 1.1.x or later version HBase as the backend database. Falcon in its release distributions will have the titan storage plugins for both BerkeleyDB and HBase.</p>
<p>----++++Using BerkeleyDB backend Falcon distributions may not package berkeley db artifacts (je-5.0.73.jar) based on build profiles. If Berkeley DB is not packaged, you can download the Berkeley DB jar file from the URL:</p>
<div class="source">
<pre>http://download.oracle.com/otn/berkeley-db/je-5.0.73.zip
</pre></div>
<p>The following properties describe an example berkeley db graph storage backend that can be specified in the configuration file</p>
<div class="source">
<pre>$FALCON_HOME/conf/startup.properties
</pre></div>
<div class="source">
<pre>
# Graph Storage
*.falcon.graph.storage.directory=${user.dir}/target/graphdb
*.falcon.graph.storage.backend=berkeleyje
*.falcon.graph.serialize.path=${user.dir}/target/graphdb

</pre></div></div>
<div class="section">
<h5>Using HBase backend<a name="Using_HBase_backend"></a></h5>
<p><verbatim>hbase-site.xml</verbatim> is provided, which can be used to start the standalone mode HBase enviornment for development/testing purposes.</p></div>
<div class="section">
<h5>Basic configuration<a name="Basic_configuration"></a></h5>
<div class="source">
<pre>
##### Falcon startup.properties
*.falcon.graph.storage.backend=hbase
#For standalone mode , specify localhost
#for distributed mode, specify zookeeper quorum here - For more information refer http://s3.thinkaurelius.com/docs/titan/current/hbase.html#_remote_server_mode_2
*.falcon.graph.storage.hostname=&lt;ZooKeeper Quorum&gt;

</pre></div>
<p><verbatim>FALCON_EXTRA_CLASS_PATH<verbatim> in <verbatim>$FALCON_HOME/bin/falcon-env.sh</verbatim>.   Additionally the correct hbase client libraries need to be added.  For example,</p>
<div class="source">
<pre>
export FALCON_EXTRA_CLASS_PATH=`${HBASE_HOME}/bin/hbase classpath`

</pre></div>
<p>Table name We recommend that in the startup config the tablename for titan storage be named &lt;verbatim&gt;falcon_titan&lt;verbatim&gt; so that multiple applications using Titan can share the same HBase cluster.   This can be set by specifying the tablename using the startup property given below. The default value is shown.</p>
<div class="source">
<pre>
*.falcon.graph.storage.hbase.table=falcon_titan

</pre></div></div>
<div class="section">
<h5>Starting standalone HBase for testing<a name="Starting_standalone_HBase_for_testing"></a></h5>
<p>HBase can be started in stand alone mode for testing as a backend for Titan. The following steps outline the config changes required:</p>
<div class="source">
<pre>
1. Build Falcon as below to package hbase binaries
   $ export MAVEN_OPTS=&quot;-Xmx1024m -XX:MaxPermSize=256m&quot; &amp;&amp; mvn clean assembly:assembly -Ppackage-standalone-hbase
2. Configure HBase
   a. When falcon tar file is expanded, HBase binaries are under ${FALCON_HOME}/hbase
   b. Copy ${FALCON_HOME}/conf/hbase-site.xml.template into hbase conf dir in ${FALCON_HOME}/hbase/conf/hbase-site.xml
   c. Set {hbase_home} property to point to a local dir
   d. Standalone HBase starts zookeeper on the default port (2181). This port can be changed by adding the following to hbase-site.xml
       &lt;property&gt;
            &lt;name&gt;hbase.zookeeper.property.clientPort&lt;/name&gt;
            &lt;value&gt;2223&lt;/value&gt;
       &lt;/property&gt;

       &lt;property&gt;
            &lt;name&gt;hbase.zookeeper.quorum&lt;/name&gt;
            &lt;value&gt;localhost&lt;/value&gt;
       &lt;/property&gt;
    e. set JAVA_HOME to point to Java 1.7 or above
    f. Start hbase as ${FALCON_HOME}/hbase/bin/start-hbase.sh
3. Configure Falcon
   a. In ${FALCON_HOME}/conf/startup.properties, uncomment the following to enable HBase as the backend
      *.falcon.graph.storage.backend=hbase
      ### specify the zookeeper host and port name with which standalone hbase is started (see step 2)
      ### by default, it will be localhost and port 2181
      *.falcon.graph.storage.hostname=&lt;zookeeper-host-name&gt;:&lt;zookeeper-host-port&gt;
      *.falcon.graph.serialize.path=${user.dir}/target/graphdb
      *.falcon.graph.storage.hbase.table=falcon_titan
      *.falcon.graph.storage.transactions=false
4. Add HBase jars to Falcon classpath in ${FALCON_HOME}/conf/falcon-env.sh as:
      FALCON_EXTRA_CLASS_PATH=`${FALCON_HOME}/hbase/bin/hbase classpath`
5. Set the following in ${FALCON_HOME}/conf/startup.properties to disable SSL if needed
      *.falcon.enableTLS=false
6. Start Falcon

</pre></div></div>
<div class="section">
<h5>Permissions<a name="Permissions"></a></h5>
<p><verbatim>falcon</verbatim> user for the <verbatim>falcon_titan</verbatim> table (or whateven tablename was specified for the property <verbatim>*.falcon.graph.storage.hbase.table</verbatim></p>
<p><verbatim>falcon_titan</verbatim>.</p>
<p>Without Ranger, HBase shell can be used to set the permissions.</p>
<div class="source">
<pre>
   su hbase
   kinit -k -t &lt;hbase keytab&gt; &lt;hbase principal&gt;
   echo &quot;grant 'falcon', 'RWXCA', 'falcon_titan'&quot; | hbase shell

</pre></div></div>
<div class="section">
<h5>Advanced configuration<a name="Advanced_configuration"></a></h5>
<p><verbatim>$FALCON_HOME/conf/startup.properties</verbatim>, by prefixing the Titan property with <verbatim>*.falcon.graph</verbatim> prefix.</p>
<p><verbatim>http://s3.thinkaurelius.com/docs/titan/0.5.4/titan-config-ref.html#_storage</verbatim> for generic storage properties, <verbaim>http://s3.thinkaurelius.com/docs/titan/0.5.4/titan-config-ref.html#_storage_berkeleydb</verbatim> for berkeley db properties and <verbatim><a class="externalLink" href="http://s3.thinkaurelius.com/docs/titan/0.5.4/titan-config-ref.html#_storage_hbase">http://s3.thinkaurelius.com/docs/titan/0.5.4/titan-config-ref.html#_storage_hbase</a></verbatim> for hbase storage backend properties.</p></div>
<div class="section">
<h4>Adding Extension Libraries<a name="Adding_Extension_Libraries"></a></h4>
<p>Library extensions allows users to add custom libraries to entity lifecycles such as feed retention, feed replication and process execution. This is useful for usecases such as adding filesystem extensions. To enable this, add the following configs to startup.properties: *.libext.paths=&lt;paths to be added to all entity lifecycles&gt;</p>
<p>*.libext.feed.paths=&lt;paths to be added to all feed lifecycles&gt;</p>
<p>*.libext.feed.retentions.paths=&lt;paths to be added to feed retention workflow&gt;</p>
<p>*.libext.feed.replication.paths=&lt;paths to be added to feed replication workflow&gt;</p>
<p>*.libext.process.paths=&lt;paths to be added to process workflow&gt;</p>
<p>The configured jars are added to falcon classpath and the corresponding workflows.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2013-2018
                        <a href="http://www.apache.org">Apache Software Foundation</a>.
            All Rights Reserved.      
                    
      </div>

                          
        
                </div>
    </footer>
  </body>
</html>
